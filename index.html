<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Warranty Check - Swastik Mobile</title>

  <!-- Firebase (compat build for simplicity) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","Segoe UI",Roboto,Arial,sans-serif;background:#f9f9f9;color:#222;min-height:100vh}
    .navbar{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;background:#fff;border-bottom:1px solid #eee;box-shadow:0 4px 10px rgba(0,0,0,.04);position:sticky;top:0;z-index:10}
    .navbar h1{font-size:20px;font-weight:700}
    .counter{color:#555;font-size:14px}
    .navbar a{background:#007aff;color:#fff;padding:10px 16px;border-radius:10px;text-decoration:none;font-weight:600}
    .container{max-width:1100px;margin:0 auto;padding:28px 20px}
    .grid{display:grid;gap:22px;grid-template-columns:repeat(auto-fit,minmax(140px,1fr))}
    .card{background:#fff;border:1px solid #eee;border-radius:18px;padding:24px 14px;box-shadow:0 10px 24px rgba(0,0,0,.06);display:flex;flex-direction:column;align-items:center;text-align:center;transition:.25s;height:190px}
    .card:hover{transform:translateY(-4px);box-shadow:0 16px 32px rgba(0,0,0,.1)}
    .card img{width:60px;height:60px;object-fit:contain;margin-bottom:14px}
    .card-name{font-size:16px;font-weight:700}
    .click-count{margin-top:8px;font-size:13px;color:#666}
    footer{text-align:center;margin:40px 0 18px;color:#999;font-size:13px}
    @media(max-width:520px){.navbar{flex-direction:column;gap:8px}}
  </style>
</head>
<body>
  <!-- NAV -->
  <div class="navbar">
    <h1>üì± Warranty Check</h1>
    <div class="counter">üëÅÔ∏è Visitors: <span id="visitorCount">0</span></div>
    <a href="contact.html">Contact Us</a>
  </div>

  <!-- BRAND GRID -->
  <div class="container">
    <div class="grid">
      <div onclick="trackClick('oppo')">
        <a href="https://support.oppo.com/in/warranty-check/" target="_blank" rel="noopener">
          <div class="card">
            <img src="https://raw.githubusercontent.com/Satyabhai/warranty-check/main/oppo.png" alt="Oppo">
            <div class="card-name">Oppo</div>
            <div class="click-count" id="count-oppo">0 warranty checks</div>
          </div>
        </a>
      </div>

      <div onclick="trackClick('vivo')">
        <a href="https://www.vivo.com/in/support/IMEI" target="_blank" rel="noopener">
          <div class="card">
            <img src="https://raw.githubusercontent.com/Satyabhai/warranty-check/main/vivo.png" alt="Vivo">
            <div class="card-name">Vivo</div>
            <div class="click-count" id="count-vivo">0 warranty checks</div>
          </div>
        </a>
      </div>

      <div onclick="trackClick('realme')">
        <a href="https://www.realme.com/in/support/phonecheck" target="_blank" rel="noopener">
          <div class="card">
            <img src="https://raw.githubusercontent.com/Satyabhai/warranty-check/main/realme.png" alt="Realme">
            <div class="card-name">Realme</div>
            <div class="click-count" id="count-realme">0 warranty checks</div>
          </div>
        </a>
      </div>

      <div onclick="trackClick('oneplus')">
        <a href="https://service.oneplus.com/in/check" target="_blank" rel="noopener">
          <div class="card">
            <img src="https://raw.githubusercontent.com/Satyabhai/warranty-check/main/oneplus.png" alt="OnePlus">
            <div class="card-name">OnePlus</div>
            <div class="click-count" id="count-oneplus">0 warranty checks</div>
          </div>
        </a>
      </div>

      <div onclick="trackClick('motorola')">
        <a href="https://en-us.support.motorola.com/app/warranty/check" target="_blank" rel="noopener">
          <div class="card">
            <img src="https://raw.githubusercontent.com/Satyabhai/warranty-check/main/moto.png" alt="Motorola">
            <div class="card-name">Motorola</div>
            <div class="click-count" id="count-motorola">0 warranty checks</div>
          </div>
        </a>
      </div>

      <div onclick="trackClick('infinix')">
        <a href="https://www.carlcare.in/in/warranty-check/" target="_blank" rel="noopener">
          <div class="card">
            <img src="https://raw.githubusercontent.com/Satyabhai/warranty-check/main/infinix.png" alt="INFINIX">
            <div class="card-name">INFINIX</div>
            <div class="click-count" id="count-infinix">0 warranty checks</div>
          </div>
        </a>
      </div>

      <div onclick="trackClick('iqoo')">
        <a href="https://www.iqoo.com/in/support/IMEI" target="_blank" rel="noopener">
          <div class="card">
            <img src="https://raw.githubusercontent.com/Satyabhai/warranty-check/main/iqoo.png" alt="IQOO">
            <div class="card-name">IQOO</div>
            <div class="click-count" id="count-iqoo">0 warranty checks</div>
          </div>
        </a>
      </div>

      <div onclick="trackClick('apple')">
        <a href="https://checkcoverage.apple.com/?locale=en_IN" target="_blank" rel="noopener">
          <div class="card">
            <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg" alt="Apple">
            <div class="card-name">Apple</div>
            <div class="click-count" id="count-apple">0 warranty checks</div>
          </div>
        </a>
      </div>
    </div>
  </div>

  <footer>Made with ‚ù§Ô∏è by Swastik Mobile</footer>

  <script>
    // --- Firebase config (YOURS) ---
    const firebaseConfig = {
      apiKey: "AIzaSyDV4v2YxTGQ1GBWsSqWDIqnVrY9rGUC1To",
      authDomain: "swastikwarranty.firebaseapp.com",
      databaseURL: "https://swastikwarranty-default-rtdb.firebaseio.com",
      projectId: "swastikwarranty",
      storageBucket: "swastikwarranty.firebasestorage.app",
      messagingSenderId: "756440563866",
      appId: "1:756440563866:web:1ca3c355fc91ed6c64df23"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // ---------- VISITOR COUNTER (always increment) ----------
    const visitorRef = db.ref("visits");

    visitorRef.transaction(current => (current || 0) + 1);

    visitorRef.on("value", snap => {
      const val = snap.val() || 0;
      document.getElementById("visitorCount").innerText = val;
    });

    // ---------- CLICK COUNTERS (8 brands) ----------
    const brands = ["oppo","vivo","realme","oneplus","motorola","infinix","iqoo","apple"];
    brands.forEach(b=>{
      db.ref("clicks/"+b).on("value", snap=>{
        const n = snap.val() || 0;
        const el = document.getElementById("count-"+b);
        if (el) el.innerText = n + " warranty checks";
      });
    });

    // ---------- AREA NAME LOGGING (silent) ----------
    function saveEvent(payload){
      try { db.ref("events").push(payload); }
      catch(e){ console.warn("Event save failed:", e); }
    }

    function getAreaName(lat, lon){
      const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=12&addressdetails=1`;
      return fetch(url).then(r=>r.json()).then(d=>{
        const a = d && d.address ? d.address : {};
        const city = a.city || a.town || a.village || a.suburb || "";
        const state = a.state || "";
        return [city, state].filter(Boolean).join(", ") || "Unknown Location";
      }).catch(()=> "Unknown Location");
    }

    function onGeoOK(brand, pos){
      const lat = pos.coords.latitude, lon = pos.coords.longitude;
      getAreaName(lat, lon).then(area=>{
        saveEvent({ type:"brand_click", brand, ts:Date.now(), area });
      });
    }

    function onGeoErr(brand){
      saveEvent({ type:"brand_click", brand, ts:Date.now(), area:"Location Not Allowed" });
    }

    function trackClick(brand){
      db.ref("clicks/"+brand).transaction(c=>(c||0)+1);
      if (navigator.geolocation){
        navigator.geolocation.getCurrentPosition(
          pos => onGeoOK(brand, pos),
          err => onGeoErr(brand),
          { timeout:8000 }
        );
      } else {
        onGeoErr(brand);
      }
    }
  </script>
</body>
</html>
